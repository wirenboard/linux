# Wiren Board 8 specific kernel options

#
# Usable kernel options
#

# Disable localversion, we include it in our package version suffix
# CONFIG_LOCALVERSION_AUTO is not set

# Disable debug info
CONFIG_DEBUG_INFO_NONE=y
# CONFIG_DEBUG_INFO_DWARF_TOOLCHAIN_DEFAULT is not set

# Disable preempt, it breaks something during shutdown
# CONFIG_PREEMPT is not set

# Add cpufreq_nvmem driver as built-in to make it available on boot
CONFIG_ARM_ALLWINNER_SUN50I_CPUFREQ_NVMEM=y

# Device tree overlays in configfs (for wb-hwconf-manager)
CONFIG_OF_OVERLAY=y
CONFIG_OF_CONFIGFS=y

# Make GPIO available in userspace
CONFIG_EXPERT=y
CONFIG_NAMESPACES=y
CONFIG_GPIO_SYSFS=y

# IIO sensors support (used in wb-mqtt-adc)
CONFIG_SENSORS_IIO_HWMON=y
CONFIG_IIO_RESCALE=y

# USB gadget support (Debug network)
CONFIG_USB_ETH=m
CONFIG_USB_GADGETFS=m

# CPU frequency governors
CONFIG_DEVFREQ_GOV_USERSPACE=y
CONFIG_DEVFREQ_GOV_PASSIVE=m

# Netfilter support
CONFIG_NF_TABLES=m
CONFIG_NF_TABLES_INET=y
CONFIG_NF_TABLES_NETDEV=y
CONFIG_NFT_NUMGEN=m
CONFIG_NFT_CT=m
CONFIG_NFT_COUNTER=m
CONFIG_NFT_CONNLIMIT=m
CONFIG_NFT_LOG=m
CONFIG_NFT_LIMIT=m
CONFIG_NFT_MASQ=m
CONFIG_NFT_REDIR=m
CONFIG_NFT_NAT=m
CONFIG_NFT_TUNNEL=m
CONFIG_NFT_OBJREF=m
CONFIG_NFT_QUEUE=m
CONFIG_NFT_QUOTA=m
CONFIG_NFT_REJECT=m
CONFIG_NFT_HASH=m
CONFIG_NFT_XFRM=m
CONFIG_NFT_SOCKET=m
CONFIG_NFT_OSF=m
CONFIG_NFT_TPROXY=m
CONFIG_NFT_SYNPROXY=m
CONFIG_NFT_DUP_NETDEV=m
CONFIG_NFT_FWD_NETDEV=m

# PPP
CONFIG_PPP=m
CONFIG_PPP_BSDCOMP=m
CONFIG_PPP_DEFLATE=m
CONFIG_PPP_FILTER=y
CONFIG_PPP_MPPE=m
CONFIG_PPP_MULTILINK=y
CONFIG_PPP_ASYNC=m
CONFIG_PPP_SYNC_TTY=m

# File systems support
CONFIG_MSDOS_FS=m
CONFIG_EXFAT_FS=m
CONFIG_NTFS_FS=m
CONFIG_NTFS_RW=y

# Detect lockups and hangs to reboot the system
CONFIG_BOOTPARAM_SOFTLOCKUP_PANIC=y
CONFIG_HARDLOCKUP_DETECTOR=y
CONFIG_BOOTPARAM_HARDLOCKUP_PANIC=y
CONFIG_DETECT_HUNG_TASK=y
CONFIG_DEFAULT_HUNG_TASK_TIMEOUT=300
CONFIG_BOOTPARAM_HUNG_TASK_PANIC=y
CONFIG_WQ_WATCHDOG=y
CONFIG_WQ_CPU_INTENSIVE_REPORT=y
CONFIG_TEST_LOCKUP=m

# Thermal interfaces
CONFIG_THERMAL_NETLINK=y
CONFIG_THERMAL_STATISTICS=y
CONFIG_THERMAL_DEBUGFS=y
CONFIG_THERMAL_EMERGENCY_POWEROFF_DELAY_MS=5000
CONFIG_THERMAL_WRITABLE_TRIPS=y

#
# Special hardware support
#

# Add I2C as built-in to make PMIC available on boot
CONFIG_I2C=y

# I2C-GPIO to communicate with WBEC, ATECC and others
CONFIG_I2C_GPIO=y

# WBEC
CONFIG_MFD_WBEC=y
CONFIG_INPUT_WBEC_PWRBUTTON=y
CONFIG_GPIO_WBEC=y
CONFIG_WBEC_POWER=y
CONFIG_WBEC_WATCHDOG=y
CONFIG_RTC_DRV_WBEC=y
CONFIG_WBEC_ADC=y
CONFIG_WBEC_BATTERY=y
CONFIG_PWM_WBEC=y
CONFIG_LEDS_WBEC=y

# SD3078 RTC (optional on boards without WBEC)
CONFIG_RTC_DRV_SD3078=y

# Ethernet
CONFIG_STMMAC_ETH=y
CONFIG_MDIO_BITBANG=y

# Set number of UARTs for 8250 driver
CONFIG_SERIAL_8250_NR_UARTS=6
CONFIG_SERIAL_8250_RUNTIME_UARTS=6

# WBMZ5 (axp20x and thermistor on ADC)
CONFIG_BATTERY_AXP20X=y
CONFIG_AXP20X_POWER=y
CONFIG_AXP20X_ADC=y
CONFIG_SENSORS_NTC_THERMISTOR=m

# Wi-Fi
CONFIG_RTL8733BU=m

# 1-Wire
CONFIG_W1=m
CONFIG_W1_MASTER_GPIO=m

# DS18B20 temperature sensor
CONFIG_W1_SLAVE_THERM=m

# WBE-AO-10V-2 DAC internal module
CONFIG_MCP4728=m

# WBIO-AO-10V-8 DAC external module
# AD5064 does not set modalias, so it must be builtin
CONFIG_AD5064=y

# WBIO-DI-* and WBIO-DO-* modules
CONFIG_PINCTRL_MCP23S08=m

# USB
CONFIG_USB_CONN_GPIO=y

# PWM
CONFIG_PWM_SUN20I=y

# Wireguard
CONFIG_NET_UDP_TUNNEL=m
CONFIG_CRYPTO_ALGAPI=m
CONFIG_WIREGUARD=m

#
# Remove unused target platforms except Allwinner
#

# CONFIG_ARCH_ACTIONS is not set
CONFIG_ARCH_SUNXI=y
# CONFIG_ARCH_ALPINE is not set
# CONFIG_ARCH_APPLE is not set
# CONFIG_ARCH_BCM is not set
# CONFIG_ARCH_BCM2835 is not set
# CONFIG_ARCH_BCM_IPROC is not set
# CONFIG_ARCH_BCMBCA is not set
# CONFIG_ARCH_BRCMSTB is not set
# CONFIG_ARCH_BERLIN is not set
# CONFIG_ARCH_EXYNOS is not set
# CONFIG_ARCH_SPARX5 is not set
# CONFIG_ARCH_K3 is not set
# CONFIG_ARCH_LG1K is not set
# CONFIG_ARCH_HISI is not set
# CONFIG_ARCH_KEEMBAY is not set
# CONFIG_ARCH_MEDIATEK is not set
# CONFIG_ARCH_MESON is not set
# CONFIG_ARCH_MVEBU is not set
# CONFIG_ARCH_NXP is not set
# CONFIG_ARCH_LAYERSCAPE is not set
# CONFIG_ARCH_MXC is not set
# CONFIG_ARCH_S32 is not set
# CONFIG_ARCH_MA35 is not set
# CONFIG_ARCH_NPCM is not set
# CONFIG_ARCH_QCOM is not set
# CONFIG_ARCH_REALTEK is not set
# CONFIG_ARCH_RENESAS is not set
# CONFIG_ARCH_ROCKCHIP is not set
# CONFIG_ARCH_SEATTLE is not set
# CONFIG_ARCH_INTEL_SOCFPGA is not set
# CONFIG_ARCH_STM32 is not set
# CONFIG_ARCH_SYNQUACER is not set
# CONFIG_ARCH_TEGRA is not set
# CONFIG_ARCH_TESLA_FSD is not set
# CONFIG_ARCH_SPRD is not set
# CONFIG_ARCH_THUNDER is not set
# CONFIG_ARCH_THUNDER2 is not set
# CONFIG_ARCH_UNIPHIER is not set
# CONFIG_ARCH_VEXPRESS is not set
# CONFIG_ARCH_VISCONTI is not set
# CONFIG_ARCH_XGENE is not set
# CONFIG_ARCH_ZYNQMP is not set

#
# Remove large unused drivers to save disk space
#

# CONFIG_PCI is not set
# CONFIG_SURFACE_PLATFORMS is not set
# CONFIG_CHROME_PLATFORMS is not set
